<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>2MB Computer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="admin_dashboard.css" />
  <link rel="stylesheet" href="{{ url_for('static', filename='admin_dashboard.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

<!-- ================= ADMIN DASHBOARD ================= -->
<div class="admin-container"> 

  <!-- Back to Store -->
  <a href="{{ url_for('home') }}" class="back-link">
  <i class="fa-solid fa-arrow-left"></i> Back to Store
</a>

  <!-- Header -->
  <div class="admin-header">
    <h1>Hi, Admin Amjad  ðŸ‘‹</h1>
    <p>Welcome back! Manage your store from here.</p>
  </div> 

  <!-- Admin Navigation Bar -->
  <div class="admin-nav">
    <div class="admin-nav-item active"><i class="fa-solid fa-table-columns"></i> Dashboard</div>
    <div class="admin-nav-item" class="Product"><i class="fa-solid fa-box"></i> Products</div>
    <div class="admin-nav-item"><i class="fa-regular fa-image"></i> Wishlist</div>
    <div class="admin-nav-item"><i class="fa-solid fa-tags"></i> Cart</div>
    <div class="admin-nav-item"><i class="fa-solid fa-cart-shopping"></i> Orders</div>
    <div class="admin-nav-item"><i class="fa-solid fa-tag"></i> Sell</div>
    <div class="admin-nav-item"><i class="fa-solid fa-screwdriver-wrench"></i> Repairs</div>
    <div class="admin-nav-item"><i class="fa-solid fa-chart-line"></i> Analytics</div>
  </div>

  <div class="admin-content">

    <div class="admin-section active" id="dashboard-section">
      <div class="admin-card">
        <h3>Welcome, Admin</h3>
        <p>Select a section above to manage your store.</p>
      </div>
    </div>

    <div class="admin-section" id="products-section">
      <div class="admin-container">
       <div class="header">
         <div>
           <h1>Admin Dashboard</h1>
           <p>Manage your store and track performance</p>
          </div>

          <a href="{{ url_for('add_product') }}" class="add-btn">
           + Add Product
          </a>
        </div>

        <div class="table-card">
          <table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Product</th>
            <th>Brand</th>
            <th>Category</th>
            <th>Price</th>
            <th>Stock</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
    </thead>

    <tbody>
        {% for product in products %}
        <tr> 
          <td><strong>{{ product.product_id }}</strong></td>
            <!-- PRODUCT + MEDIA -->
            <td>
                <strong>{{ product.name }}</strong>
                
                <div style="margin-top:6px;">
    {% set first_image = product.media | selectattr('filetype', 'equalto', 'image') | list | first %}
    
    {% if first_image %}
        <img src="{{ url_for('static', filename='uploads/' + first_image.filename) }}"
             width="50"
             style="margin-right:6px; border-radius:4px;">
    {% endif %}
</div>
            </td>

            <td>{{ product.brand }}</td>
            <td>{{ product.device_type }}</td>
            <td>â‚¹{{ product.real_price }}</td>
            <td>{{ product.stock }}</td>

            <!-- STATUS LOGIC -->
            <td>
                {% if product.stock >= 15 %}
                    <span class="status in-stock">In Stock</span>
                {% elif product.stock <= 5 %}
                    <span class="status low-stock">Low Stock</span>
                {% else %}
                    <span class="status medium-stock">Medium</span>
                {% endif %}
            </td>

            <!-- ACTIONS -->
            <td>
                <a href="{{ url_for('edit_product', product_id=product.id) }}">
                    Edit
                </a>
                <br><br>

                <button class="delete-btn" data-id="{{ product.id }}">
                    Delete
                </button>
            </td>

        </tr>
        {% endfor %}
    </tbody>
</table>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="{{ url_for('static', filename='admin_dashboard.js') }}"></script>
</body>
</html>
